(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{122:function(e,t,n){},143:function(e,t,n){"use strict";n.r(t);var a=n(5),s=n(6),r=n(0),i=n(1),c=n(35),o=n.n(c),l=n(13),d=n(19),u=n(42),j=n(49),m=n(7),b=n(99),O=n(3),f=n(96),p=(n(122),n(18)),h=n.n(p),v=n(23),x=n(16),g=n(146),k=n(147),y=n(60),C=n.n(y),S=n(69),w=[{name:"Brightness",property:"brightness",value:100,range:{min:0,max:200},unit:"%"},{name:"Contrast",property:"contrast",value:100,range:{min:0,max:200},unit:"%"},{name:"Saturation",property:"saturate",value:100,range:{min:0,max:200},unit:"%"},{name:"Grayscale",property:"grayscale",value:0,range:{min:0,max:100},unit:"%"},{name:"Sepia",property:"sepia",value:0,range:{min:0,max:100},unit:"%"},{name:"Hue Rotate",property:"hue-rotate",value:0,range:{min:0,max:360},unit:"deg"},{name:"Blur",property:"blur",value:0,range:{min:0,max:20},unit:"px"}],N=function(e){var t=e.file,n=e.setNewFile,c=e.setFilterRem,o=Object(i.useState)(w),l=Object(a.a)(o,2),d=l[0],u=l[1],j=Object(i.useState)(0),m=Object(a.a)(j,2),b=m[0],O=m[1],f=d[b],p=function(){return{filter:d.map((function(e){return"".concat(e.property,"(").concat(e.value).concat(e.unit,")")})).join(" ")}},h={display:"none"};Object(i.useEffect)((function(){c(p().filter)}),[f]);var v=Object(i.useState)(null),x=Object(a.a)(v,2),g=x[0],k=x[1],y=Object(i.useState)(null),C=Object(a.a)(y,2),N=C[0],$=C[1],I=document.getElementById("original-image"),L=document.getElementById("filtered-canvas");return Object(r.jsxs)("div",{children:[Object(r.jsx)("img",{id:"original-image",src:t?URL.createObjectURL(t):null,alt:t?t.name:null,style:h,onLoad:function(){N&&(S.filterImage(L,N,I),k(L.toDataURL(t.type)),L.toBlob((function(e){var a=new File([e],t.name,{type:"image/jpeg"});n(a)}),"image/jpeg",.5))}}),null===t||"mp4"===t.name.split(".").pop()?null:Object(r.jsx)("img",{id:"filtered-image",width:"100%",src:g||(t?URL.createObjectURL(t):null),alt:t?t.name:null,style:p()}),Object(r.jsx)("canvas",{id:"filtered-canvas",style:h}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),null===t||"mp4"===t.name.split(".").pop()?null:Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"button-filter",children:d.map((function(e,t){return Object(r.jsx)("button",{type:"button",className:"btn btn-warning",onClick:function(){return O(t)},children:e.name},t)}))}),Object(r.jsx)("input",{type:"range",min:f.range.min,max:f.range.max,value:f.value,onChange:function(e){u((function(t){return t.map((function(t,n){return n!==b?t:Object(s.a)(Object(s.a)({},t),{},{value:e.target.value})}))}))}}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("h3",{children:"More advanced filter options..."}),Object(r.jsxs)("select",{id:"filter-changer",onChange:function(e){"none"!==e.target.value?$((function(){return S[e.target.value]})):(k(null),$(null),n(null))},children:[Object(r.jsx)("option",{value:"none",children:"None"}),Object(r.jsx)("option",{value:"red",children:"Red"}),Object(r.jsx)("option",{value:"gaussian",children:"Gaussian"}),Object(r.jsx)("option",{value:"highpass",children:"highpass"}),Object(r.jsx)("option",{value:"invert",children:"invert"}),Object(r.jsx)("option",{value:"laplacian",children:"laplacian"}),Object(r.jsx)("option",{value:"prewittHorizontal",children:"Prewitt Horizontal"}),Object(r.jsx)("option",{value:"prewittVertical",children:"Prewitt Vertical"}),Object(r.jsx)("option",{value:"roberts",children:"roberts"}),Object(r.jsx)("option",{value:"sharpen",children:"sharpen"}),Object(r.jsx)("option",{value:"sobelHorizontal",children:"sobel Horizontal"}),Object(r.jsx)("option",{value:"sobelVertical",children:"sobel Vertical"}),Object(r.jsx)("option",{value:"thresholding",children:"thresholding"})]})]})]})};function $(){var e=Object(x.a)(["\nmutation s3PreSign($key: String!, $type: String!) {\n    s3PreSign(\n        key: $key\n        type: $type\n    ) {\n        url\n    }\n}"]);return $=function(){return e},e}var I=Object(m.gql)($()),L=function(e){var t=e.handleClose,n=e.show,s=e.userID,c=e.addPost,o=e.setError,l=e.setSuccess,d=Object(m.useMutation)(I),u=Object(a.a)(d,2),j=u[0],b=u[1],O=Object(i.useState)(null),f=Object(a.a)(O,2),p=f[0],x=f[1],y=Object(i.useState)(null),S=Object(a.a)(y,2),w=S[0],$=S[1],L=Object(i.useState)(null),D=Object(a.a)(L,2),E=D[0],P=D[1],R=Object(i.useState)("brightness(100%) contrast(100%) saturate(100%) grayscale(0%) sepia(0%) hue-rotate(0deg) blur(0px)"),T=Object(a.a)(R,2),H=T[0],M=T[1],q=function(){var e=Object(v.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=p.name,a=p.type,P(t.target.title.value),j({variables:{key:n,type:a}}),t.target.title.value="";case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){if(b.data&&p){var e=b.data.s3PreSign.url,t=w||p;C.a.put(e,t,{headers:{"Content-Type":t.type}}).then((function(e){var n="https://daisy-ins.s3.amazonaws.com/".concat(t.name),a=s,r=H;function i(){return(i=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c({variables:{url:n,title:E,user:a,filter:r}});case 3:l("Add Post Successfully!"),setTimeout((function(){return l(null)}),3e3),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),o(e.t0.message),setTimeout((function(){return o(null)}),3e3);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){i.apply(this,arguments)}(),x(null),$(null)})).catch((function(e){o(e),setTimeout((function(){return o(null)}),3e3)}))}}),[b.data]),Object(r.jsx)("div",{children:Object(r.jsx)(g.a,{show:n,onHide:t,children:Object(r.jsxs)("form",{onSubmit:q,children:[Object(r.jsx)(g.a.Header,{closeButton:!0,children:Object(r.jsx)(g.a.Title,{children:"Add Post"})}),Object(r.jsxs)(g.a.Body,{children:[Object(r.jsx)("input",{type:"file",name:"image",id:"imageLoader",onChange:function(e){x(e.target.files[0]),$(null)},required:!0}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)(N,{file:p,setNewFile:$,setFilterRem:M,newFile:w}),Object(r.jsx)("textarea",{type:"text",name:"title",placeholder:"Your comment within 100 letters...",required:!0})]}),Object(r.jsxs)(g.a.Footer,{children:[Object(r.jsx)(k.a,{variant:"secondary",onClick:t,children:"Close"}),Object(r.jsx)(k.a,{className:"btn btn-primary",type:"submit",variant:"primary",onClick:t,children:"Save Changes"})]})]})})})},D=function(e){var t=e.show,n=e.handleClose,a=e.userID,s=e.addChildComment,i=e.comment_id,c=e.reply_user,o=e.setError,l=e.setSuccess,d=function(){var e=Object(v.a)(h.a.mark((function e(t){var n,r,d,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.childComment.value,r=a,d=i,u=c,e.prev=5,e.next=8,s({variables:{content:n,user:r,parentComment:d,replyTo:u}});case 8:l("Comment Added!"),setTimeout((function(){return l(null)}),3e3),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(5),o(e.t0.message),setTimeout((function(){return o(null)}),3e3);case 16:t.target.childComment.value="";case 17:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{children:Object(r.jsx)(g.a,{show:t,onHide:n,children:Object(r.jsxs)("form",{onSubmit:d,children:[Object(r.jsx)(g.a.Header,{closeButton:!0,children:Object(r.jsx)(g.a.Title,{children:"Reply Here"})}),Object(r.jsx)(g.a.Body,{children:Object(r.jsx)("textarea",{type:"text",name:"childComment",placeholder:"Your comment within 50 letters..."})}),Object(r.jsxs)(g.a.Footer,{children:[Object(r.jsx)(k.a,{variant:"secondary",onClick:n,children:"Close"}),Object(r.jsx)(k.a,{type:"submit",variant:"primary",onClick:n,children:"Save Changes"})]})]})})})};function E(){var e=Object(x.a)(["\nmutation removeFriend($id: ID!, $friends: [ID]!) {\n    removeFriend(\n        id: $id\n        friends: $friends\n    ) {\n        username\n        avatar\n        friends {\n            id\n        }\n        posts {\n            id\n        }\n        id\n    }\n}"]);return E=function(){return e},e}function P(){var e=Object(x.a)(["\nmutation addFriend($id: ID!, $friends: [ID]!) {\n    addFriend(\n        id: $id\n        friends: $friends\n    ) {\n        username\n        avatar\n        friends {\n            id\n        }\n        posts {\n            id\n        }\n        id\n    }\n}"]);return P=function(){return e},e}function R(){var e=Object(x.a)(["\nquery findUser($id: ID!) {\n    findUser(id: $id) {\n        username\n        avatar\n        friends {\n            id\n        }\n        posts {\n            id\n        }\n        id\n    }\n}"]);return R=function(){return e},e}function T(){var e=Object(x.a)(["\nmutation removeChildCommentLikes($id: ID!, $likes: [ID]!) {\n    removeChildCommentLikes(\n        id: $id\n        likes: $likes\n    ) {\n        content\n        updated\n        likes {\n            id\n        }\n        user {\n            username\n            avatar\n            id\n        }\n        replyTo {\n            username\n        }\n        parentComment {\n            id\n        }\n        id\n    }\n}"]);return T=function(){return e},e}function H(){var e=Object(x.a)(["\nmutation addChildCommentLikes($id: ID!, $likes: [ID]!) {\n    addChildCommentLikes(\n        id: $id\n        likes: $likes\n    ) {\n        content\n        updated\n        likes {\n            id\n        }\n        user {\n            username\n            avatar\n            id\n        }\n        replyTo {\n            username\n        }\n        parentComment {\n            id\n        }\n        id\n    }\n}"]);return H=function(){return e},e}function M(){var e=Object(x.a)(["\nmutation addChildComment($content: String!, $user: ID!, $parentComment: ID!, $replyTo: ID!) {\n    addChildComment(\n        content: $content\n        user: $user\n        replyTo: $replyTo\n        parentComment: $parentComment\n    ) {\n        content\n        updated\n        likes {\n            id\n        }\n        user {\n            username\n            avatar\n            id\n        }\n        replyTo {\n            username\n        }\n        parentComment {\n            id\n        }\n        id\n    }\n}"]);return M=function(){return e},e}function q(){var e=Object(x.a)(["\nmutation removeCommentLikes($id: ID!, $likes: [ID]!) {\n    removeCommentLikes(\n        id: $id\n        likes: $likes\n    ) {\n        content\n        updated\n        likes {\n            id\n        }\n        user {\n            username\n            avatar\n            id\n        }\n        post {\n            id\n        }\n        childComments {\n            content\n            updated\n            likes {\n              id\n            }\n            user {\n                username\n                avatar\n                id\n            }\n            replyTo {\n                username\n            }\n            parentComment {\n              id\n            }\n            id\n        }\n        id\n    }\n}"]);return q=function(){return e},e}function U(){var e=Object(x.a)(["\nmutation addCommentLikes($id: ID!, $likes: [ID]!) {\n    addCommentLikes(\n        id: $id\n        likes: $likes\n    ) {\n        content\n        updated\n        likes {\n            id\n        }\n        user {\n            username\n            avatar\n            id\n        }\n        post {\n            id\n        }\n        childComments {\n            content\n            updated\n            likes {\n              id\n            }\n            user {\n                username\n                avatar\n                id\n            }\n            replyTo {\n                username\n            }\n            parentComment {\n              id\n            }\n            id\n        }\n        id\n    }\n}"]);return U=function(){return e},e}function _(){var e=Object(x.a)(["\nmutation addComment($content: String!, $user: ID!, $post: ID!) {\n    addComment(\n        content: $content\n        user: $user\n        post: $post\n    ) {\n        content\n        updated\n        likes {\n            id\n        }\n        user {\n            username\n            avatar\n            id\n        }\n        post {\n            id\n        }\n        childComments {\n            content\n            updated\n            likes {\n              id\n            }\n            user {\n                username\n                avatar\n                id\n            }\n            replyTo {\n                username\n            }\n            parentComment {\n              id\n            }\n            id\n        }\n        id\n    }\n}"]);return _=function(){return e},e}function V(){var e=Object(x.a)(["\nmutation removePostLikes($id: ID!, $likes: [ID]!) {\n    removePostLikes(\n        id: $id\n        likes: $likes\n    ) {\n        url\n        filter\n        title\n        updated\n        likes {\n            id\n        }\n        id\n        user {\n            username\n            avatar\n            friends {\n                id\n            }\n            id\n        }\n        comments {\n            content\n            updated\n            likes {\n                id\n            }\n            user {\n                username\n                avatar\n                id\n            }\n            post {\n                id\n            }\n            childComments {\n                content\n                updated\n                likes {\n                  id\n                }\n                user {\n                    username\n                    avatar\n                }\n                replyTo {\n                    username\n                }\n                parentComment {\n                  id\n                }\n                id\n            }\n            id\n        }\n    }\n}"]);return V=function(){return e},e}function A(){var e=Object(x.a)(["\nmutation addPostLikes($id: ID!, $likes: [ID]!) {\n    addPostLikes(\n        id: $id\n        likes: $likes\n    ) {\n        url\n        filter\n        title\n        updated\n        likes {\n            id\n        }\n        id\n        user {\n            username\n            avatar\n            friends {\n                id\n            }\n            id\n        }\n        comments {\n            content\n            updated\n            likes {\n                id\n            }\n            user {\n                username\n                avatar\n                id\n            }\n            post {\n                id\n            }\n            childComments {\n                content\n                updated\n                likes {\n                  id\n                }\n                user {\n                    username\n                    avatar\n                }\n                replyTo {\n                    username\n                }\n                parentComment {\n                  id\n                }\n                id\n            }\n            id\n        }\n    }\n}"]);return A=function(){return e},e}function B(){var e=Object(x.a)(["\nmutation addPost($url: String!, $filter: String!, $title: String!, $user: ID!) {\n    addPost(\n        url: $url\n        filter: $filter\n        title: $title\n        user: $user\n    ) {\n        url\n        filter\n        title\n        updated\n        likes {\n            id\n        }\n        id\n        user {\n            username\n            avatar\n            friends {\n                id\n            }\n            id\n        }\n        comments {\n            content\n            updated\n            likes {\n                id\n            }\n            user {\n                username\n                avatar\n                id\n            }\n            post {\n                id\n            }\n            childComments {\n                content\n                updated\n                likes {\n                  id\n                }\n                user {\n                    username\n                    avatar\n                }\n                replyTo {\n                    username\n                }\n                parentComment {\n                  id\n                }\n                id\n            }\n            id\n        }\n    }\n}"]);return B=function(){return e},e}function F(){var e=Object(x.a)(["\nquery {\n    allPosts {\n        url\n        filter\n        title\n        updated\n        likes {\n            id\n        }\n        id\n        user {\n            username\n            avatar\n            friends {\n                id\n            }\n            id\n        }\n        comments {\n            content\n            updated\n            likes {\n                id\n            }\n            user {\n                username\n                avatar\n                id\n            }\n            post {\n                id\n            }\n            childComments {\n                content\n                updated\n                likes {\n                  id\n                }\n                user {\n                    username\n                    avatar\n                    id\n                }\n                replyTo {\n                    username\n                }\n                parentComment {\n                  id\n                }\n                id\n            }\n            id\n        }\n    }\n}"]);return F=function(){return e},e}var z=Object(m.gql)(F()),Q=Object(m.gql)(B()),W=Object(m.gql)(A()),G=Object(m.gql)(V()),Y=Object(m.gql)(_()),J=Object(m.gql)(U()),K=Object(m.gql)(q()),X=Object(m.gql)(M()),Z=Object(m.gql)(H()),ee=Object(m.gql)(T()),te=Object(m.gql)(R()),ne=Object(m.gql)(P()),ae=Object(m.gql)(E()),se=function(e){var t=e.comment,n=e.userID,c=e.postsAll,o=e.setPostsAll,d=e.childCommentVisible,u=e.handleReplyShow,j=e.style,b=e.styleHeartRed,O=e.styleHeartBlack,f=Object(m.useMutation)(Z),p=Object(a.a)(f,2),h=p[0],v=p[1],x=Object(m.useMutation)(ee),g=Object(a.a)(x,2),k=g[0],y=g[1];Object(i.useEffect)((function(){if(v.data){var e=c.find((function(e){return e.comments.find((function(e){return e.id===v.data.addChildCommentLikes.parentComment.id}))}));o((function(t){return t.map((function(t){return t.id===e.id?Object(s.a)(Object(s.a)({},t),{},{comments:t.comments.map((function(e){return e.id===v.data.addChildCommentLikes.parentComment.id?Object(s.a)(Object(s.a)({},e),{},{childComments:e.childComments.map((function(e){return e.id===v.data.addChildCommentLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:v.data.addChildCommentLikes.likes}):e}))}):e}))}):t}))}))}}),[v.data]),Object(i.useEffect)((function(){if(y.data){var e=c.find((function(e){return e.comments.find((function(e){return e.id===y.data.removeChildCommentLikes.parentComment.id}))}));o((function(t){return t.map((function(t){return t.id===e.id?Object(s.a)(Object(s.a)({},t),{},{comments:t.comments.map((function(e){return e.id===y.data.removeChildCommentLikes.parentComment.id?Object(s.a)(Object(s.a)({},e),{},{childComments:e.childComments.map((function(e){return e.id===y.data.removeChildCommentLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:y.data.removeChildCommentLikes.likes}):e}))}):e}))}):t}))}))}}),[y.data]);return Object(r.jsx)("div",{style:d[t.id]?{display:"",marginLeft:"50px"}:{display:"none",marginLeft:"50px"},children:t.childComments.map((function(e){return Object(r.jsxs)("div",{className:"post-comment",children:[Object(r.jsx)("div",{children:Object(r.jsx)(l.b,{to:"/user/".concat(e.user.id),children:Object(r.jsx)("img",{src:e.user.avatar,alt:"avatar not display ".concat(e.id),width:"30px",height:"30px",className:"avatar-img-main"})})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:Object(r.jsxs)("b",{children:[e.user.username,Object(r.jsx)("i",{className:"fas fa-arrow-right mx-3"}),e.replyTo.username]})}),Object(r.jsx)("p",{className:"post-content",children:e.content}),Object(r.jsx)("p",{children:new Date(parseInt(e.updated)).toLocaleString()})]}),Object(r.jsxs)("div",{className:"post-comment-reply-likes",children:[Object(r.jsxs)("button",{style:e.likes.find((function(e){return e.id===n}))?b:O,onClick:function(){return function(e){if(null!==localStorage.getItem("token")){var t=e.likes.find((function(e){return e.id===n})),a=e.likes.map((function(e){return e.id}));t?k({variables:{id:e.id,likes:a.filter((function(e){return e!==n}))}}):h({variables:{id:e.id,likes:a.concat(n)}})}}(e)},children:[Object(r.jsx)("i",{className:"far fa-heart fa-1x"}),Object(r.jsx)("b",{children:e.likes.length})]}),Object(r.jsx)("button",{style:j,onClick:function(){return u(t.id,e.user.id)},children:"Reply"})]})]},e.id)}))})},re=function(e){var t=e.post,n=e.userID,a=e.postsAll,i=e.setPostsAll,c=e.setReplyShow,o=e.setCommentID,d=e.setReplyUser,u=e.setChildCommentVisible,j=e.removeCommentLikes,m=e.addCommentLikes,b=e.addComment,O=e.commentVisible,f=e.childCommentVisible,p=e.style,x=e.styleHeartRed,g=e.styleHeartBlack,k=e.setError,y=e.setSuccess,C=function(e,t){c(!0),o(e),d(t)},S=function(){var e=Object(v.a)(h.a.mark((function e(t){var a,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=t.target.content.value,s=t.target.post_id.value,e.prev=3,e.next=6,b({variables:{content:a,user:n,post:s}});case 6:y("Comment Added!"),setTimeout((function(){return y(null)}),3e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),k(e.t0.message),setTimeout((function(){return k(null)}),3e3);case 14:t.target.content.value="";case 15:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}(),w={display:"none"},N={display:""};return Object(r.jsx)("div",{children:Object(r.jsxs)("div",{style:O[t.id]?N:w,children:[t.comments.map((function(e){return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"post-comment",children:[Object(r.jsx)("div",{children:Object(r.jsx)(l.b,{to:"/user/".concat(e.user.id),children:Object(r.jsx)("img",{src:e.user.avatar,alt:"avatar not display ".concat(e.id),width:"30px",height:"30px",className:"avatar-img-main"})})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:Object(r.jsx)("b",{children:e.user.username})}),Object(r.jsx)("p",{className:"post-content",children:e.content}),Object(r.jsx)("p",{children:new Date(parseInt(e.updated)).toLocaleString()}),0===e.childComments.length?Object(r.jsx)("div",{}):Object(r.jsxs)("small",{onClick:function(){return function(e){if(f[e]){var t=Object(s.a)({},f);t[e]=!1,u(t)}else{var n=Object(s.a)({},f);n[e]=!0,u(n)}}(e.id)},children:[" ",Object(r.jsxs)("b",{children:["Show ",e.childComments.length," comments"]})," "]})]}),Object(r.jsxs)("div",{className:"post-comment-reply-likes",children:[Object(r.jsxs)("button",{style:e.likes.find((function(e){return e.id===n}))?x:g,onClick:function(){return function(e){if(null!==localStorage.getItem("token")){var t=e.likes.find((function(e){return e.id===n})),a=e.likes.map((function(e){return e.id}));t?j({variables:{id:e.id,likes:a.filter((function(e){return e!==n}))}}):m({variables:{id:e.id,likes:a.concat(n)}})}}(e)},children:[Object(r.jsx)("i",{className:"far fa-heart fa-1x"}),Object(r.jsx)("b",{children:e.likes.length})]}),Object(r.jsx)("button",{style:p,onClick:function(){return C(e.id,e.user.id)},children:"Reply"})]})]}),Object(r.jsx)(se,{childCommentVisible:f,showWhenVisible:N,hideWhenVisible:w,comment:e,style:p,userID:n,postsAll:a,setPostsAll:i,styleHeartRed:x,styleHeartBlack:g,handleReplyShow:C})]},e.id)})),Object(r.jsxs)("form",{className:"comment-form m-5",onSubmit:S,children:[Object(r.jsx)("input",{type:"hidden",name:"post_id",value:t.id}),Object(r.jsx)("input",{type:"text",name:"content"}),Object(r.jsx)("button",{style:p,type:"submit",children:Object(r.jsx)("i",{className:"fas fa-share fa-2x"})})]})]})})},ie=function(e){var t=e.userID,n=e.setReplyShow,c=e.handleUploadClose,o=e.uploadShow,d=e.handleReplyClose,u=e.replyShow,j=e.error,b=e.success,O=e.setError,f=e.setSuccess,p=Object(i.useState)(null),h=Object(a.a)(p,2),v=h[0],x=h[1],g=Object(i.useState)({}),k=Object(a.a)(g,2),y=k[0],C=k[1],S=Object(i.useState)({}),w=Object(a.a)(S,2),N=w[0],$=w[1],I=Object(i.useState)(!1),E=Object(a.a)(I,2),P=E[0],R=E[1],T=Object(i.useState)(null),H=Object(a.a)(T,2),M=H[0],q=H[1],U=Object(i.useState)(null),_=Object(a.a)(U,2),V=_[0],A=_[1],B=Object(m.useQuery)(z),F=Object(m.useLazyQuery)(te),Z=Object(a.a)(F,2),ee=Z[0],se=Z[1],ie=Object(i.useState)([]),ce=Object(a.a)(ie,2),oe=ce[0],le=ce[1],de=Object(m.useMutation)(Q),ue=Object(a.a)(de,2),je=ue[0],me=ue[1],be=Object(m.useMutation)(W),Oe=Object(a.a)(be,2),fe=Oe[0],pe=Oe[1],he=Object(m.useMutation)(G),ve=Object(a.a)(he,2),xe=ve[0],ge=ve[1],ke=Object(m.useMutation)(Y),ye=Object(a.a)(ke,2),Ce=ye[0],Se=ye[1],we=Object(m.useMutation)(J),Ne=Object(a.a)(we,2),$e=Ne[0],Ie=Ne[1],Le=Object(m.useMutation)(K),De=Object(a.a)(Le,2),Ee=De[0],Pe=De[1],Re=Object(m.useMutation)(X),Te=Object(a.a)(Re,2),He=Te[0],Me=Te[1],qe=Object(m.useMutation)(ne),Ue=Object(a.a)(qe,2),_e=Ue[0],Ve=Ue[1],Ae=Object(m.useMutation)(ae),Be=Object(a.a)(Ae,2),Fe=Be[0],ze=Be[1],Qe=function(e){if(v){var n=v.friends.find((function(t){return t.id===e})),a=v.friends.map((function(e){return e.id}));n?Fe({variables:{id:t,friends:a.filter((function(t){return t!==e}))}}):_e({variables:{id:t,friends:a.concat(e)}})}},We={border:"none",outline:"none",backgroundColor:"white"},Ge={width:"20px",height:"20px",color:"white",backgroundColor:"red",borderRadius:"50%",display:"grid",justifyContent:"center",alignContent:"center",position:"relative",left:"30%",bottom:"80%"},Ye={display:"none"},Je={border:"none",outline:"none",color:"red",backgroundColor:"white"},Ke={border:"none",outline:"none",color:"black",backgroundColor:"white"};return Object(i.useEffect)((function(){se.data&&x(se.data.findUser)}),[se.data]),Object(i.useEffect)((function(){Ve.data&&x(Ve.data.addFriend)}),[Ve.data]),Object(i.useEffect)((function(){ze.data&&x(ze.data.removeFriend)}),[ze.data]),Object(i.useEffect)((function(){B.data&&!1===P&&(null!==t&&ee({variables:{id:t}}),le(B.data.allPosts),C(B.data.allPosts.reduce((function(e,t){return e[t.id]=!1,e}),{})),$(B.data.allPosts.reduce((function(e,t){return t.comments.map((function(t){return e[t.id]=!1})),e}),{})),R(!0))}),[B.data]),Object(i.useEffect)((function(){if(me.data){le((function(e){return e.concat(me.data.addPost)}));var e=Object(s.a)({},y);e[me.data.addPost.id]=!1,C(e)}}),[me.data]),Object(i.useEffect)((function(){pe.data&&le((function(e){return e.map((function(e){return e.id===pe.data.addPostLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:pe.data.addPostLikes.likes}):e}))}))}),[pe.data]),Object(i.useEffect)((function(){ge.data&&le((function(e){return e.map((function(e){return e.id===ge.data.removePostLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:ge.data.removePostLikes.likes}):e}))}))}),[ge.data]),Object(i.useEffect)((function(){if(Se.data){le((function(e){return e.map((function(e){return e.id===Se.data.addComment.post.id?Object(s.a)(Object(s.a)({},e),{},{comments:e.comments.concat(Se.data.addComment)}):e}))}));var e=Object(s.a)({},N);e[Se.data.addComment.id]=!1,$(e)}}),[Se.data]),Object(i.useEffect)((function(){Ie.data&&(console.log(Ie.data.addCommentLikes),le((function(e){return e.map((function(e){return e.id===Ie.data.addCommentLikes.post.id?Object(s.a)(Object(s.a)({},e),{},{comments:e.comments.map((function(e){return e.id===Ie.data.addCommentLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:Ie.data.addCommentLikes.likes}):e}))}):e}))})))}),[Ie.data]),Object(i.useEffect)((function(){Pe.data&&le((function(e){return e.map((function(e){return e.id===Pe.data.removeCommentLikes.post.id?Object(s.a)(Object(s.a)({},e),{},{comments:e.comments.map((function(e){return e.id===Pe.data.removeCommentLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:Pe.data.removeCommentLikes.likes}):e}))}):e}))}))}),[Pe.data]),Object(i.useEffect)((function(){if(Me.data){var e=oe.find((function(e){return e.comments.find((function(e){return e.id===Me.data.addChildComment.parentComment.id}))}));le((function(t){return t.map((function(t){return t.id===e.id?Object(s.a)(Object(s.a)({},t),{},{comments:t.comments.map((function(e){return e.id===Me.data.addChildComment.parentComment.id?Object(s.a)(Object(s.a)({},e),{},{childComments:e.childComments.concat(Me.data.addChildComment)}):e}))}):t}))}))}}),[Me.data]),Object(r.jsxs)("div",{className:"content",children:[oe.loading?Object(r.jsx)("div",{children:"loading..."}):Object(r.jsx)("div",{children:oe.map((function(e){return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"onePost mb-5",children:[Object(r.jsxs)("div",{className:"img-user-title-date",children:[Object(r.jsx)(l.b,{to:"/post/".concat(e.id),children:"mp4"===e.url.split(".").pop()?Object(r.jsx)("video",{controls:!0,children:Object(r.jsx)("source",{src:e.url,type:"video/mp4"})}):Object(r.jsx)("img",{style:{filter:"".concat(e.filter)},className:"p-3",src:e.url,alt:"not display ".concat(e.id)})}),Object(r.jsx)(l.b,{to:"/user/".concat(e.user.id),children:Object(r.jsxs)("h5",{children:["@ ",e.user.username]})}),Object(r.jsx)("h5",{className:"post-content",children:e.title}),Object(r.jsx)("small",{children:new Date(parseInt(e.updated)).toLocaleString()})]}),Object(r.jsxs)("div",{className:"avatar-fontawesome",children:[Object(r.jsxs)("div",{className:"avatar-img-main-position",children:[Object(r.jsx)(l.b,{to:"/user/".concat(e.user.id),children:Object(r.jsx)("img",{src:e.user.avatar,alt:"avatar not display ".concat(e.id),width:"50px",height:"50px",className:"avatar-img-main"})}),v?Object(r.jsx)("span",{style:v.friends.find((function(t){return t.id===e.user.id}))?Ye:Ge,onClick:function(){return Qe(e.user.id)},children:Object(r.jsx)("i",{className:"fas fa-plus"})}):Object(r.jsx)("span",{style:Ge,onClick:function(){return Qe(e.user.id)},children:Object(r.jsx)("i",{className:"fas fa-plus"})})]}),Object(r.jsxs)("button",{style:e.likes.find((function(e){return e.id===t}))?Je:Ke,onClick:function(){return function(e){if(null!==localStorage.getItem("token")){var n=e.likes.find((function(e){return e.id===t})),a=e.likes.map((function(e){return e.id}));n?xe({variables:{id:e.id,likes:a.filter((function(e){return e!==t}))}}):fe({variables:{id:e.id,likes:a.concat(t)}})}}(e)},children:[Object(r.jsx)("i",{className:"far fa-heart fa-2x"}),Object(r.jsx)("b",{children:e.likes.length})]}),Object(r.jsxs)("button",{style:We,onClick:function(){return function(e){if(y[e]){var t=Object(s.a)({},y);t[e]=!1,C(t)}else{var n=Object(s.a)({},y);n[e]=!0,C(n)}}(e.id)},children:[Object(r.jsx)("i",{className:"far fa-comment-dots fa-2x"}),Object(r.jsx)("b",{children:e.comments.length})]})]})]}),Object(r.jsx)(re,{post:e,userID:t,postsAll:oe,commentVisible:y,childCommentVisible:N,setPostsAll:le,setChildCommentVisible:$,setReplyShow:n,setCommentID:q,setReplyUser:A,removeCommentLikes:Ee,addCommentLikes:$e,addComment:Ce,style:We,styleHeartRed:Je,styleHeartBlack:Ke,setError:O,setSuccess:f})]},e.id)}))}),Object(r.jsx)(L,{handleClose:c,show:o,userID:t,addPost:je,error:j,success:b,setError:O,setSuccess:f}),Object(r.jsx)(D,{handleClose:d,show:u,userID:t,addChildComment:He,comment_id:M,reply_user:V,setError:O,setSuccess:f})]})},ce=function(e){var t=e.error,n=e.success;return Object(r.jsxs)("div",{children:[t?Object(r.jsx)("div",{className:"alert alert-danger",children:t}):null,n?Object(r.jsx)("div",{className:"alert alert-success",children:n}):null]})},oe=function(e){var t=e.token,n=e.setToken,s=e.userID,c=e.username,o=e.error,d=e.success,u=e.setError,j=e.setSuccess,b=Object(i.useState)(!1),O=Object(a.a)(b,2),f=O[0],p=O[1],h=Object(i.useState)(!1),v=Object(a.a)(h,2),x=v[0],g=v[1],k=Object(m.useApolloClient)(),y={border:"none"};return Object(r.jsxs)("div",{className:"home",children:[Object(r.jsx)("div",{children:Object(r.jsxs)("div",{className:"navbar",children:[Object(r.jsx)("div",{className:"nav-user",children:null===t?Object(r.jsx)("h4",{className:"welcome",children:Object(r.jsx)("i",{children:"Welcome"})}):Object(r.jsx)(l.b,{to:"/user/".concat(s),children:Object(r.jsx)("h4",{children:Object(r.jsx)("i",{children:c})})})}),Object(r.jsx)("div",{className:"nav-post",children:null===t?null:Object(r.jsx)("div",{children:Object(r.jsx)("button",{style:y,onClick:function(){return p(!0)},children:Object(r.jsx)("i",{className:"fas fa-edit fa-2x"})})})}),Object(r.jsx)("div",{className:"nav-login",children:Object(r.jsx)(l.b,{to:"/login",children:Object(r.jsx)("button",{style:y,children:Object(r.jsx)("i",{className:"fas fa-user-plus fa-2x"})})})}),Object(r.jsx)("div",{className:"nav-logout",children:Object(r.jsx)("button",{style:y,className:"px-2",onClick:function(){n(null),localStorage.clear(),k.resetStore()},children:Object(r.jsx)("i",{className:"fas fa-sign-out-alt fa-2x"})})}),Object(r.jsxs)("div",{className:"footer",children:[Object(r.jsx)("p",{children:"\xa9 Created by Daisy Dai"}),Object(r.jsx)("p",{children:"Created on 12/02/2020"})]})]})}),Object(r.jsxs)("div",{children:[Object(r.jsx)(ce,{error:o,success:d}),Object(r.jsx)(ie,{userID:s,setReplyShow:g,handleUploadClose:function(){return p(!1)},uploadShow:f,handleReplyClose:function(){g(!1)},replyShow:x,error:o,success:d,setError:u,setSuccess:j})]})]})};function le(){var e=Object(x.a)(["\nmutation login($username: String!, $passwordHash: String!) {\n    login(\n        username: $username\n        passwordHash: $passwordHash\n    ) {\n        value\n        username\n        id\n    }\n}"]);return le=function(){return e},e}var de=Object(m.gql)(le()),ue=function(e){var t=e.setToken,n=e.setUsername,s=e.setUserID,c=e.error,o=e.success,d=e.setError,u=e.setSuccess,j=Object(m.useMutation)(de),b=Object(a.a)(j,2),O=b[0],f=b[1],p=function(){var e=Object(v.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.username.value,a=t.target.pwd.value,e.prev=3,e.next=6,O({variables:{username:n,passwordHash:a}});case 6:u("Login Successfully!"),setTimeout((function(){return u(null)}),3e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),d(e.t0.message),setTimeout((function(){return d(null)}),3e3);case 14:t.target.username.value="",t.target.pwd.value="";case 16:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){f.data&&(t(f.data.login.value),n(f.data.login.username),s(f.data.login.id),localStorage.setItem("token",f.data.login.value),localStorage.setItem("username",f.data.login.username),localStorage.setItem("id",f.data.login.id))}),[s,n,t,f.data]),Object(r.jsx)("div",{className:"login-bigger",children:Object(r.jsxs)("form",{onSubmit:p,className:"login",children:[Object(r.jsx)(ce,{error:c,success:o}),Object(r.jsx)("input",{type:"text",name:"username",placeholder:"Username",required:!0}),Object(r.jsx)("input",{type:"text",name:"pwd",placeholder:"Password",required:!0}),Object(r.jsx)("input",{type:"submit",value:"Log In"}),Object(r.jsxs)("small",{children:["Don't have an account yet? Please ",Object(r.jsx)(l.b,{to:"/register",children:"register here."})]})]})})};function je(){var e=Object(x.a)(["\nmutation s3PreSign($key: String!, $type: String!) {\n    s3PreSign(\n        key: $key\n        type: $type\n    ) {\n        url\n    }\n}"]);return je=function(){return e},e}function me(){var e=Object(x.a)(["\nmutation createUser($username: String!, $avatar: String!, $passwordHash: String!) {\n    createUser(\n        username: $username\n        avatar: $avatar\n        passwordHash: $passwordHash\n    ) {\n        id\n    }\n}"]);return me=function(){return e},e}var be=Object(m.gql)(me()),Oe=Object(m.gql)(je()),fe=function(e){var t=e.error,n=e.success,s=e.setError,c=e.setSuccess,o=Object(d.g)(),l=Object(m.useMutation)(be),u=Object(a.a)(l,1)[0],j=Object(m.useMutation)(Oe),b=Object(a.a)(j,2),O=b[0],f=b[1],p=Object(i.useState)(null),x=Object(a.a)(p,2),g=x[0],k=x[1],y=Object(i.useState)(null),S=Object(a.a)(y,2),w=S[0],N=S[1],$=Object(i.useState)(null),I=Object(a.a)($,2),L=I[0],D=I[1],E=function(){var e=Object(v.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),k(t.target.avatar.files[0]),N(t.target.username.value),D(t.target.pwd.value),n=t.target.avatar.files[0].name,a=t.target.avatar.files[0].type,e.prev=6,e.next=9,O({variables:{key:n,type:a}});case 9:c("Upload Successfully"),setTimeout((function(){return c(null)}),3e3),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(6),s("Something wrong, please try again"),setTimeout((function(){return s(null)}),3e3);case 17:t.target.username.value="",t.target.pwd.value="";case 19:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){if(f.data){var e=f.data.s3PreSign.url;C.a.put(e,g,{headers:{"Content-Type":g.type}}).then((function(e){var t="https://daisy-ins.s3.amazonaws.com/".concat(g.name);function n(){return(n=Object(v.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u({variables:{username:w,avatar:t,passwordHash:L}});case 3:c("Please login"),setTimeout((function(){return c(null)}),3e3),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),s(e.t0.message),setTimeout((function(){return s(null)}),3e3);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){n.apply(this,arguments)}(),o.push("/login")})).catch((function(e){s(e.message),setTimeout((function(){return s(null)}),3e3)}))}}),[u,f.data]),Object(r.jsx)("div",{className:"register-bigger",children:Object(r.jsxs)("form",{onSubmit:E,className:"register",children:[Object(r.jsx)(ce,{error:t,success:n}),Object(r.jsx)("input",{type:"text",name:"username",placeholder:"Username",required:!0}),Object(r.jsx)("input",{type:"text",name:"pwd",placeholder:"Password",required:!0}),Object(r.jsx)("input",{type:"file",name:"avatar",required:!0}),Object(r.jsx)("input",{type:"submit",value:"Register"})]})})};function pe(){var e=Object(x.a)(["\nquery findUser($id: ID) {\n  findUser(id: $id) {\n    username\n    avatar\n    id\n    friends {\n        username\n        avatar\n        id\n    }\n    posts {\n        filter\n        url\n        id\n    }\n  }\n}"]);return pe=function(){return e},e}var he=Object(m.gql)(pe()),ve=function(){var e=Object(d.h)().id,t=Object(u.b)(),n=Object(m.useLazyQuery)(he),s=Object(a.a)(n,2),c=s[0],o=s[1],j=Object(i.useState)(null),b=Object(a.a)(j,2),O=b[0],f=b[1];return Object(i.useEffect)((function(){null!==e&&c({variables:{id:e}})}),[e]),Object(i.useEffect)((function(){o.data&&(f(o.data.findUser),t({type:"SAVE_USER",data:o.data.findUser}))}),[o.data]),Object(r.jsx)("div",{children:O?Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"userinfo-avatar-button p-5",children:[Object(r.jsx)("img",{src:O.avatar,alt:O.id,width:"100",height:"100",className:"avatar-img"}),Object(r.jsx)(l.b,{to:"/friends/".concat(O.id),children:Object(r.jsxs)("h4",{children:[" ",O.friends.length," friends "]})}),Object(r.jsxs)("h4",{children:[" Hello, ",O.username," "]})]}),Object(r.jsxs)("div",{children:[Object(r.jsxs)("h6",{className:"my-5 p-5",children:[O.posts.length," Post(s)"]}),Object(r.jsx)("div",{className:"grid-userinfo-posts",children:O.posts.map((function(e){return Object(r.jsx)("div",{children:Object(r.jsx)(l.b,{to:"/post/".concat(e.id),children:"mp4"===e.url.split(".").pop()?Object(r.jsx)("video",{width:"500",height:"300",controls:!0,children:Object(r.jsx)("source",{src:e.url,type:"video/mp4"})}):Object(r.jsx)("img",{style:{filter:"".concat(e.filter)},src:e.url,width:"500",height:"300",alt:"imagenotdisplay ".concat(e.id)})})},e.id)}))})]})]}):Object(r.jsx)("div",{children:"Loading..."})})},xe=function(e){var t=e.comment,n=e.userID,c=e.style,o=e.styleHeartRed,d=e.styleHeartBlack,u=e.childCommentVisible,j=e.postInfo,b=e.setPostInfo,O=e.handleReplyShow,f=Object(m.useMutation)(Z),p=Object(a.a)(f,2),h=p[0],v=p[1],x=Object(m.useMutation)(ee),g=Object(a.a)(x,2),k=g[0],y=g[1];return Object(i.useEffect)((function(){if(v.data){var e=Object(s.a)(Object(s.a)({},j),{},{comments:j.comments.map((function(e){return e.id===v.data.addChildCommentLikes.parentComment.id?Object(s.a)(Object(s.a)({},e),{},{childComments:e.childComments.map((function(e){return e.id===v.data.addChildCommentLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:v.data.addChildCommentLikes.likes}):e}))}):e}))});b(e)}}),[v.data]),Object(i.useEffect)((function(){if(y.data){var e=Object(s.a)(Object(s.a)({},j),{},{comments:j.comments.map((function(e){return e.id===y.data.removeChildCommentLikes.parentComment.id?Object(s.a)(Object(s.a)({},e),{},{childComments:e.childComments.map((function(e){return e.id===y.data.removeChildCommentLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:y.data.removeChildCommentLikes.likes}):e}))}):e}))});b(e)}}),[y.data]),Object(r.jsx)("div",{style:u[t.id]?{display:"",marginLeft:"50px"}:{display:"none",marginLeft:"50px"},children:t.childComments.map((function(e){return Object(r.jsxs)("div",{className:"postComment",children:[Object(r.jsx)("div",{children:Object(r.jsx)(l.b,{to:"/user/".concat(e.user.id),children:Object(r.jsx)("img",{src:e.user.avatar,alt:"avatar not display ".concat(e.id),width:"30px",height:"30px",className:"avatar-img-main"})})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:Object(r.jsxs)("b",{children:[e.user.username,Object(r.jsx)("i",{className:"fas fa-arrow-right mx-3"}),e.replyTo.username]})}),Object(r.jsx)("p",{className:"post-content",children:e.content}),Object(r.jsx)("p",{children:new Date(parseInt(e.updated)).toLocaleString()})]}),Object(r.jsxs)("div",{className:"postComment-reply-likes",children:[Object(r.jsxs)("button",{style:e.likes.find((function(e){return e.id===n}))?o:d,onClick:function(){return function(e){if(null!==localStorage.getItem("token")){var t=e.likes.find((function(e){return e.id===n})),a=e.likes.map((function(e){return e.id}));t?k({variables:{id:e.id,likes:a.filter((function(e){return e!==n}))}}):h({variables:{id:e.id,likes:a.concat(n)}})}}(e)},children:[Object(r.jsx)("i",{className:"far fa-heart fa-1x"}),Object(r.jsx)("b",{children:e.likes.length})]}),Object(r.jsx)("button",{style:c,onClick:function(){return O(t.id,e.user.id)},children:"Reply"})]})]},e.id)}))})},ge=function(e){var t=e.postShow,n=e.style,c=e.postInfo,o=e.userID,d=e.styleHeartRed,u=e.styleHeartBlack,j=e.setPostInfo,b=e.childCommentVisible,O=e.setChildCommentVisible,f=e.setReplyShow,p=e.setCommentID,x=e.setReplyUser,g=e.setError,k=e.setSuccess,y={display:"none"},C={display:""},S=Object(m.useMutation)(Y),w=Object(a.a)(S,2),N=w[0],$=w[1],I=Object(m.useMutation)(J),L=Object(a.a)(I,2),D=L[0],E=L[1],P=Object(m.useMutation)(K),R=Object(a.a)(P,2),T=R[0],H=R[1],M=function(){var e=Object(v.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.content.value,a=t.target.post_id.value,e.prev=3,e.next=6,N({variables:{content:n,user:o,post:a}});case 6:k("Comment Added!"),setTimeout((function(){return k(null)}),3e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),g(e.t0.message),setTimeout((function(){return g(null)}),3e3);case 14:t.target.content.value="";case 15:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}(),q=function(e,t){f(!0),p(e),x(t)};return Object(i.useEffect)((function(){if($.data){var e=Object(s.a)(Object(s.a)({},c),{},{comments:c.comments.concat($.data.addComment)});j(e)}}),[$.data]),Object(i.useEffect)((function(){if(E.data){var e=Object(s.a)(Object(s.a)({},c),{},{comments:c.comments.map((function(e){return e.id===E.data.addCommentLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:E.data.addCommentLikes.likes}):e}))});j(e)}}),[E.data]),Object(i.useEffect)((function(){if(H.data){var e=Object(s.a)(Object(s.a)({},c),{},{comments:c.comments.map((function(e){return e.id===H.data.removeCommentLikes.id?Object(s.a)(Object(s.a)({},e),{},{likes:H.data.removeCommentLikes.likes}):e}))});j(e)}}),[H.data]),Object(r.jsx)("div",{style:t?C:y,children:c?Object(r.jsxs)("div",{children:[c.comments.map((function(e){return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"postComment",children:[Object(r.jsx)("div",{children:Object(r.jsx)(l.b,{to:"/user/".concat(e.user.id),children:Object(r.jsx)("img",{src:e.user.avatar,alt:"avatar not display ".concat(e.id),width:"30px",height:"30px",className:"avatar-img-main"})})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:Object(r.jsx)("b",{children:e.user.username})}),Object(r.jsx)("p",{className:"post-content",children:e.content}),Object(r.jsx)("p",{children:new Date(parseInt(e.updated)).toLocaleString()}),0===e.childComments.length?Object(r.jsx)("div",{}):Object(r.jsxs)("small",{onClick:function(){return function(e){if(b[e]){var t=Object(s.a)({},b);t[e]=!1,O(t)}else{var n=Object(s.a)({},b);n[e]=!0,O(n)}}(e.id)},children:[" ",Object(r.jsxs)("b",{children:["Show ",e.childComments.length," comments"]})," "]})]}),Object(r.jsxs)("div",{className:"postComment-reply-likes",children:[Object(r.jsxs)("button",{style:e.likes.find((function(e){return e.id===o}))?d:u,onClick:function(){return function(e){if(null!==localStorage.getItem("token")){var t=e.likes.find((function(e){return e.id===o})),n=e.likes.map((function(e){return e.id}));t?T({variables:{id:e.id,likes:n.filter((function(e){return e!==o}))}}):D({variables:{id:e.id,likes:n.concat(o)}})}}(e)},children:[Object(r.jsx)("i",{className:"far fa-heart fa-1x"}),Object(r.jsx)("b",{children:e.likes.length})]}),Object(r.jsx)("button",{style:n,onClick:function(){return q(e.id,e.user.id)},children:"Reply"})]})]}),Object(r.jsx)(xe,{comment:e,postInfo:c,style:n,userID:o,styleHeartRed:d,styleHeartBlack:u,childCommentVisible:b,hideWhenVisible:y,showWhenVisible:C,setPostInfo:j,handleReplyShow:q})]},e.id)})),Object(r.jsxs)("form",{className:"comment-form m-5",onSubmit:M,children:[Object(r.jsx)("input",{type:"hidden",name:"post_id",value:c.id}),Object(r.jsx)("input",{type:"text",name:"content"}),Object(r.jsx)("button",{style:n,type:"submit",children:Object(r.jsx)("i",{className:"fas fa-share fa-2x"})})]})]}):Object(r.jsx)("div",{children:"Loading..."})})};function ke(){var e=Object(x.a)(["\nquery findPost($id: ID) {\n    findPost(id: $id) {\n        id\n        url\n        filter\n        title\n        updated\n        likes {\n            id\n        }\n        user {\n            id\n            username\n            avatar\n        }\n        comments {\n            content\n            updated\n            likes {\n                id\n            }\n            user {\n                username\n                avatar\n                id\n            }\n            post {\n                id\n            }\n            childComments {\n                content\n                updated\n                likes {\n                  id\n                }\n                user {\n                    username\n                    avatar\n                    id\n                }\n                replyTo {\n                    username\n                }\n                parentComment {\n                  id\n                }\n                id\n            }\n            id\n        }\n    }\n}"]);return ke=function(){return e},e}var ye=Object(m.gql)(ke()),Ce=function(e){var t=e.userID,n=e.error,c=e.success,o=e.setError,u=e.setSuccess,j=Object(m.useLazyQuery)(ye),b=Object(a.a)(j,2),O=b[0],f=b[1],p=Object(m.useMutation)(W),h=Object(a.a)(p,2),v=h[0],x=h[1],g=Object(m.useMutation)(G),k=Object(a.a)(g,2),y=k[0],C=k[1],S=Object(m.useMutation)(X),w=Object(a.a)(S,2),N=w[0],$=w[1],I=Object(m.useLazyQuery)(te),L=Object(a.a)(I,2),E=L[0],P=L[1],R=Object(m.useMutation)(ne),T=Object(a.a)(R,2),H=T[0],M=T[1],q=Object(m.useMutation)(ae),U=Object(a.a)(q,2),_=U[0],V=U[1],A=Object(d.h)().id,B=Object(i.useState)(null),F=Object(a.a)(B,2),z=F[0],Q=F[1],Y=Object(i.useState)(null),J=Object(a.a)(Y,2),K=J[0],Z=J[1],ee=Object(i.useState)(!1),se=Object(a.a)(ee,2),re=se[0],ie=se[1],oe=Object(i.useState)(!1),le=Object(a.a)(oe,2),de=le[0],ue=le[1],je=Object(i.useState)({}),me=Object(a.a)(je,2),be=me[0],Oe=me[1],fe=Object(i.useState)(!1),pe=Object(a.a)(fe,2),he=pe[0],ve=pe[1],xe=Object(i.useState)(null),ke=Object(a.a)(xe,2),Ce=ke[0],Se=ke[1],we=Object(i.useState)(null),Ne=Object(a.a)(we,2),$e=Ne[0],Ie=Ne[1],Le={border:"none",outline:"none",backgroundColor:"white"},De={width:"20px",height:"20px",color:"white",backgroundColor:"red",borderRadius:"50%",display:"grid",justifyContent:"center",alignContent:"center",position:"relative",left:"30%",bottom:"80%"},Ee={border:"none",outline:"none",color:"red",backgroundColor:"white"},Pe={border:"none",outline:"none",color:"black",backgroundColor:"white"},Re=function(e){if(K){var n=K.friends.find((function(t){return t.id===e})),a=K.friends.map((function(e){return e.id}));n?_({variables:{id:t,friends:a.filter((function(t){return t!==e}))}}):H({variables:{id:t,friends:a.concat(e)}})}};return Object(i.useEffect)((function(){P.data&&Z(P.data.findUser)}),[P.data]),Object(i.useEffect)((function(){M.data&&Z(M.data.addFriend)}),[M.data]),Object(i.useEffect)((function(){V.data&&Z(V.data.removeFriend)}),[V.data]),Object(i.useEffect)((function(){null!==A&&O({variables:{id:A}})}),[A]),Object(i.useEffect)((function(){f.data&&!1===de&&(Q(f.data.findPost),ue(!0),Oe(f.data.findPost.comments.reduce((function(e,t){return e[t.id]=!1,e}),{})),E({variables:{id:t}}))}),[f.data]),Object(i.useEffect)((function(){if(x.data){var e=Object(s.a)(Object(s.a)({},z),{},{likes:x.data.addPostLikes.likes});Q(e)}}),[x.data]),Object(i.useEffect)((function(){if(C.data){var e=Object(s.a)(Object(s.a)({},z),{},{likes:C.data.removePostLikes.likes});Q(e)}}),[C.data]),Object(i.useEffect)((function(){if($.data){var e=Object(s.a)(Object(s.a)({},z),{},{comments:z.comments.map((function(e){return e.id===$.data.addChildComment.parentComment.id?Object(s.a)(Object(s.a)({},e),{},{childComments:e.childComments.concat($.data.addChildComment)}):e}))});Q(e)}}),[$.data]),Object(r.jsxs)("div",{className:"post-main-container",children:[Object(r.jsx)(ce,{error:n,success:c}),z?Object(r.jsxs)("div",{className:"post-individual-page",children:[Object(r.jsxs)("div",{className:"post-img",children:["mp4"===z.url.split(".").pop()?Object(r.jsx)("video",{controls:!0,children:Object(r.jsx)("source",{src:z.url,type:"video/mp4"})}):Object(r.jsx)("img",{style:{filter:"".concat(z.filter)},src:z.url,alt:"imageNotDisplay ".concat(z.id)}),Object(r.jsx)(l.b,{to:"/user/".concat(z.user.id),children:Object(r.jsxs)("h5",{children:["@ ",z.user.username]})}),Object(r.jsx)("h5",{className:"post-content",children:z.title}),Object(r.jsx)("small",{children:new Date(parseInt(z.updated)).toLocaleString()})]}),Object(r.jsxs)("div",{className:"post-avatar-button mt-3",children:[Object(r.jsxs)("div",{className:"avatar-img-main-position",children:[Object(r.jsx)(l.b,{to:"/user/".concat(z.user.id),children:Object(r.jsx)("img",{src:z.user.avatar,alt:"imageNotDisplay ".concat(z.id),width:"50",height:"50",className:"avatar-img-main"})}),K?Object(r.jsx)("span",{style:K.friends.find((function(e){return e.id===z.user.id}))?{display:"none"}:De,onClick:function(){return Re(z.user.id)},children:Object(r.jsx)("i",{className:"fas fa-plus"})}):Object(r.jsx)("span",{style:De,onClick:function(){return Re(z.user.id)},children:Object(r.jsx)("i",{className:"fas fa-plus"})})]}),Object(r.jsxs)("button",{style:z.likes.find((function(e){return e.id===t}))?Ee:Pe,onClick:function(){return function(e){if(null!==localStorage.getItem("token")){var n=e.likes.find((function(e){return e.id===t})),a=e.likes.map((function(e){return e.id}));n?y({variables:{id:e.id,likes:a.filter((function(e){return e!==t}))}}):v({variables:{id:e.id,likes:a.concat(t)}})}}(z)},children:[Object(r.jsx)("i",{className:"far fa-heart fa-2x"}),Object(r.jsx)("b",{children:z.likes.length})]}),Object(r.jsxs)("button",{style:Le,onClick:function(){ie(!1===re)},children:[Object(r.jsx)("i",{className:"far fa-comment-dots fa-2x"}),Object(r.jsx)("b",{children:z.comments.length})]})]}),Object(r.jsx)(ge,{postShow:re,style:Le,postInfo:z,userID:t,styleHeartRed:Ee,styleHeartBlack:Pe,childCommentVisible:be,setPostInfo:Q,setChildCommentVisible:Oe,setReplyShow:ve,setCommentID:Se,setReplyUser:Ie,error:n,success:c,setError:o,setSuccess:u})]}):Object(r.jsx)("div",{children:"Loading..."}),Object(r.jsx)(D,{userID:t,show:he,comment_id:Ce,reply_user:$e,handleClose:function(){return ve(!1)},addChildComment:N,setReplyShow:ve,setCommentID:Se,setReplyUser:Ie,setError:o,setSuccess:u})]})};function Se(){var e=Object(x.a)(["\nsubscription postMessage($channel_name: String!) {\n    postMessage(\n        channel_name: $channel_name\n    ) {\n        id\n        username\n        content\n        channel_name\n        created_at\n    }\n}\n"]);return Se=function(){return e},e}function we(){var e=Object(x.a)(["\nmutation postMessage($username: String, $content: String!, $channel_name: String!, $created_at: String) {\n    postMessage(\n        username: $username,\n        content: $content,\n        channel_name: $channel_name,\n        created_at: $created_at\n    ) {\n        id\n        username\n        content\n        channel_name\n        created_at\n    }\n}"]);return we=function(){return e},e}var Ne=Object(m.gql)(we()),$e=Object(m.gql)(Se()),Ie=function(e){var t=e.error,n=e.success,s=e.setError,c=e.setSuccess,o=Object(u.c)((function(e){return e.user})),d=Object(i.useState)(null),j=Object(a.a)(d,2),b=j[0],O=j[1],f=Object(i.useState)(null),p=Object(a.a)(f,2),x=p[0],g=p[1],k=Object(i.useState)([]),y=Object(a.a)(k,2),C=y[0],S=y[1],w=Object(m.useMutation)(Ne),N=Object(a.a)(w,1)[0];Object(m.useSubscription)($e,{variables:{channel_name:x},onSubscriptionData:function(e){var t=e.subscriptionData;console.log(t.data.postMessage.username),S(C.concat(t.data.postMessage)),b!==t.data.postMessage.username&&(c("You received message from ".concat(t.data.postMessage.username)),setTimeout((function(){return c(null)}),3e3))}});var $=function(){var e=Object(v.a)(h.a.mark((function e(t){var n,a,r,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=x,a=t.target.chat.value,r=b,i=new Date,e.prev=5,e.next=8,N({variables:{username:n,content:a,channel_name:r,created_at:i}});case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(5),s(e.t0.message),setTimeout((function(){return s(null)}),3e3);case 14:S(C.concat({username:n,content:a,channel_name:r,created_at:i})),t.target.chat.value="";case 16:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){o&&g(o.username)}),[o]),Object(r.jsx)("div",{className:"container",children:null===o?Object(r.jsx)(l.b,{to:"/",children:"Go back Home"}):Object(r.jsxs)("div",{id:"friends-grid",children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("h3",{children:" Friend Lists "}),Object(r.jsx)("ul",{className:"navbar-ul mt-5",children:o.friends.map((function(e){return Object(r.jsx)("button",{onClick:function(){return t=e.username,O(t),void S([]);var t},children:Object(r.jsxs)("li",{children:[Object(r.jsx)("img",{src:o.avatar,alt:o.id,width:"50",height:"50",className:"avatar-img-main mr-2"}),e.username]})},e.id)}))})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)(ce,{error:t,success:n}),Object(r.jsx)("div",{className:"chatRoom",children:C.filter((function(e){return e.username===b||e.channel_name===b})).map((function(e,t){return Object(r.jsx)("div",{className:"chat-total",children:e.username===o.username?Object(r.jsx)("ul",{className:"chat-left",children:Object(r.jsxs)("li",{className:"chat-li-left",children:[Object(r.jsx)("p",{className:"chat-me",children:" Me "}),Object(r.jsx)("p",{className:"text-left",children:e.content})]})}):Object(r.jsx)("ul",{className:"chat-right",children:Object(r.jsxs)("li",{className:"chat-li-right",children:[Object(r.jsx)("p",{className:"text-right",children:e.content}),Object(r.jsxs)("p",{className:"chat-mate",children:[" ",e.username," "]})]})})},t)}))}),Object(r.jsxs)("form",{onSubmit:$,id:"chat-form",children:[Object(r.jsx)("input",{type:"text",name:"chat"}),Object(r.jsx)("button",{type:"submit",children:" Enter "})]})]})]})})},Le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SAVE_USER":return e=t.data;default:return e}},De=Object(j.b)({user:Le}),Ee=Object(j.c)(De),Pe=Object(b.a)((function(e,t){var n=t.headers,a=localStorage.getItem("phonenumbers-user-token");return{headers:Object(s.a)(Object(s.a)({},n),{},{authorization:a?"bearer ".concat(a):null})}})),Re=new m.HttpLink({uri:"https://insdaisy.daisywebdev.com/graphql"}),Te=new f.a({uri:"wss://insdaisy.daisywebdev.com/graphql-ws",options:{reconnect:!0}}),He=Object(m.split)((function(e){var t=e.query,n=Object(O.p)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),Te,Pe.concat(Re)),Me=new m.ApolloClient({cache:new m.InMemoryCache({typePolicies:{Post:{fields:{likes:{merge:function(e,t){return t}}}},Comment:{fields:{likes:{merge:function(e,t){return t}}}},ChildComment:{fields:{likes:{merge:function(e,t){return t}}}},User:{fields:{friends:{merge:function(e,t){return t}}}}}}),link:He}),qe=function(){var e=Object(i.useState)(localStorage.getItem("token")),t=Object(a.a)(e,2),n=t[0],s=t[1],c=Object(i.useState)(localStorage.getItem("username")),o=Object(a.a)(c,2),u=o[0],j=o[1],m=Object(i.useState)(localStorage.getItem("id")),b=Object(a.a)(m,2),O=b[0],f=b[1],p=Object(i.useState)(null),h=Object(a.a)(p,2),v=h[0],x=h[1],g=Object(i.useState)(null),k=Object(a.a)(g,2),y=k[0],C=k[1];return Object(r.jsx)("div",{children:Object(r.jsx)(l.a,{children:Object(r.jsxs)(d.d,{children:[Object(r.jsx)(d.b,{exact:!0,path:"/post/:id",children:Object(r.jsx)(Ce,{userID:O,error:v,success:y,setError:x,setSuccess:C})}),Object(r.jsx)(d.b,{exact:!0,path:"/user/:id",children:Object(r.jsx)(ve,{})}),Object(r.jsx)(d.b,{exact:!0,path:"/friends/:id",children:Object(r.jsx)(Ie,{error:v,success:y,setError:x,setSuccess:C})}),Object(r.jsx)(d.b,{exact:!0,path:"/register",children:Object(r.jsx)(fe,{error:v,success:y,setError:x,setSuccess:C})}),Object(r.jsx)(d.b,{exact:!0,path:"/login",children:null!==n?Object(r.jsx)(d.a,{to:"/"}):Object(r.jsx)(ue,{setToken:s,setUsername:j,setUserID:f,error:v,success:y,setError:x,setSuccess:C})}),Object(r.jsx)(d.b,{exact:!0,path:"/",children:Object(r.jsx)(oe,{setToken:s,token:n,userID:O,username:u,error:v,success:y,setError:x,setSuccess:C})})]})})})};o.a.render(Object(r.jsxs)(m.ApolloProvider,{client:Me,children:[Object(r.jsx)(u.a,{store:Ee,children:Object(r.jsx)(qe,{})}),","]}),document.getElementById("root"))}},[[143,1,2]]]);
//# sourceMappingURL=main.9527d892.chunk.js.map